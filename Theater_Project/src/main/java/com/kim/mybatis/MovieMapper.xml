<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kim.mybatis.MovieMapper">
	<!-- 리스트 -->
	<select id= "getAllMovie" parameterType="hashMap" resultType="MovieBean">
		SELECT *
		FROM (
		        SELECT A.*,
		            ROWNUM AS RNUM
		        FROM (
		                SELECT  NO
		                      , TITLE
		                      , DIRECTOR
		                      , ACTOR
		                      , RELEASEDATE
		                      , ENDDATE
		                      , RUNNINGTIME
		                      , COUNTRY
		                      , INFO
		                      , POSTERIMG
		                      , GENRE
		                      , AGE
		                FROM MOVIE
		                ORDER BY NO DESC
		            ) A 
		        WHERE ROWNUM <![CDATA[<=]]> #{end}
		    )
		WHERE RNUM <![CDATA[>=]]> #{start}
	</select>
	
	<!-- 영화등록 -->
	<insert id = "insertMovie" parameterType="MovieBean">
		INSERT INTO MOVIE(
			  NO
            , TITLE
            , DIRECTOR
            , ACTOR
            , RELEASEDATE
            , ENDDATE
            , RUNNINGTIME
            , COUNTRY
            , INFO
            , POSTERIMG
            , GENRE
            , AGE
		)
		VALUES (
			  MOVIE_SEQ.NEXTVAL
			, #{title}
			, #{director}
			, #{actor}
			, #{releaseDate}
			, #{endDate}
			, #{runningTime}
			, #{country}
			, #{info}
			, #{posterImg}
			, #{genre}
			, #{age}
		)
	</insert>
	<select id = "getSelectOneMovie" parameterType="Integer" resultType="MovieBean">
		SELECT  NO
              , TITLE
              , DIRECTOR
              , ACTOR
              , RELEASEDATE
              , ENDDATE
              , RUNNINGTIME
              , COUNTRY
              , INFO
              , POSTERIMG
              , GENRE
              , AGE
		FROM MOVIE
		WHERE NO = #{no}
	</select>
	
	<delete id="deleteMovie" parameterType="Integer">
		DELETE FROM MOVIE WHERE NO = #{no}
	</delete>
	
	<update id="updateMovie" parameterType="MovieBean">
		UPDATE MOVIE SET (
			, TITLE
            , DIRECTOR
            , ACTOR
            , RELEASEDATE
            , ENDDATE
            , RUNNINGTIME
            , COUNTRY
            , INFO
            , POSTERIMG
            , GENRE
            , AGE
		)
		VALUES (
			#{title}
		  , #{director}
		  , #{actor}
		  , #{releaseDate}
		  , #{endDate}
		  , #{runningTime}
		  , #{country}
		  , #{info}
		  , #{posterImg}
		  , #{genre}
		  , #{age}
		)
	</update>

	<!-- 전체 영화리스트 수 -->
	<select id="getTotal" resultType="Integer">
		SELECT COUNT(*) AS TOTAL FROM MOVIE
	</select>
</mapper>
